#pragma once

#include <Arduino.h>

const float sigmoid101[101] = {0.000000,
0.000708,
0.001490,
0.002352,
0.003303,
0.004352,
0.005509,
0.006785,
0.008191,
0.009740,
0.011447,
0.013326,
0.015394,
0.017671,
0.020174,
0.022926,
0.025950,
0.029270,
0.032913,
0.036908,
0.041286,
0.046077,
0.051318,
0.057044,
0.063293,
0.070104,
0.077517,
0.085576,
0.094320,
0.103793,
0.114037,
0.125090,
0.136992,
0.149777,
0.163477,
0.178117,
0.193716,
0.210287,
0.227832,
0.246345,
0.265807,
0.286188,
0.307448,
0.329530,
0.352368,
0.375879,
0.399973,
0.424547,
0.449490,
0.474682,
0.500000,
0.525318,
0.550510,
0.575453,
0.600027,
0.624121,
0.647632,
0.670470,
0.692552,
0.713812,
0.734193,
0.753655,
0.772168,
0.789713,
0.806284,
0.821883,
0.836523,
0.850223,
0.863008,
0.874910,
0.885963,
0.896207,
0.905680,
0.914424,
0.922483,
0.929896,
0.936707,
0.942956,
0.948682,
0.953923,
0.958714,
0.963092,
0.967087,
0.970730,
0.974050,
0.977074,
0.979826,
0.982329,
0.984606,
0.986674,
0.988553,
0.990260,
0.991809,
0.993215,
0.994491,
0.995648,
0.996697,
0.997648,
0.998510,
0.999292,
1.000000,

};

struct airgap_transition {
    public:
    static float step();
    static void init(float airgap_start);
    static void start_transition(float target_airgap, float time);

    private:
    static bool m_in_transition;
    static float m_airgap_start;
    static float m_airgap_current;
    static float m_airgap_end;
    static float m_transition_time;
    static int m_transition_step_counter;
    static int m_transition_counter;
    static int m_step_cycles;
};